gfortran -cpp -J ../mod -I ../mod -c -Wall -O2 -DDEBUG analysis/diffraction/diffractionCRP6D.f90 -o ../bin/diffractionCRP6D.o
analysis/diffraction/diffractionCRP6D.f90:18.1:

 REAL(KIND=8) :: Psi ! azimuthal exit angle
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:19.1:

 REAL(KIND=8) :: Phi ! deflection angle respect to incidence plane
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:20.1:

 REAL(KIND=8) :: Theta_out ! deflection angle respect to surface plane
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:21.1:

 REAL(KIND=8) :: Prob ! probability
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:67.1:

 REAL(KIND=8), DIMENSION(2) :: kinit_par
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:68.1:

 REAL(KIND=8), DIMENSION(3) :: p ! momentum
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:69.1:

 LOGICAL, DIMENSION(:), ALLOCATABLE :: allowed
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:70.1:

 LOGICAL :: need_cycle
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:71.1:

 REAL(KIND=8) :: pinit_par
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:72.1:

 REAL(KIND=8) :: E ! Total energy
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:73.1:

 REAL(KIND=8) :: gamma ! angle between surface main vectors.
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:74.1:

 REAL(KIND=8) :: Psi ! azimuthal exit angle
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:75.1:

 REAL(KIND=8) :: Phi ! deflection angle respect to incidence plane
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:76.1:

 REAL(KIND=8) :: Theta_out ! deflection angle respect to surface plane
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:78.1:

 INTEGER(KIND=4) :: i, k ! Counters
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:79.1:

 INTEGER(KIND=4) :: order
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:80.1:

 INTEGER(KIND=4) :: count_peaks
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:81.1:

 INTEGER(KIND=4), DIMENSION(2) :: g ! (n,m) vector
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:82.1:

 CHARACTER(LEN=19), PARAMETER :: routinename = "SET_ALLOWED_PEAKS: "
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:84.1:

 REAL(KIND=8) :: a, b ! axis longitude
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:85.1:

 REAL(KIND=8) :: beta ! angle of incident beam projected on unit cell surface
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:86.1:

 REAL(KIND=8) :: theta_in ! incidence angle measured from surface plane
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:88.1:

 a=this%surf%norm_s1
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:89.1:

 b=this%surf%norm_s2
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:90.1:

 beta=this%inicond%vpar_angle%getvalue()
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:91.1:

 theta_in=this%inicond%vz_angle%getvalue()
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:94.1:

 CALL VERBOSE_WRITE(routinename,"Starting job")
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:96.1:

 E = (this%inicond%E_norm)/(dsin(theta_in))**2.D0
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:97.1:

 this%E = E
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:98.1:

 gamma = DACOS(DOT_PRODUCT(this%surf%s1,this%surf%s2)/(a*b))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:100.1:

 pinit_par = DSQRT(2.D0*mass*(E - this%inicond%E_norm%getvalue()))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:101.1:

 kinit_par(1) = pinit_par*a*DCOS(beta)/(2.D0*PI)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:102.1:

 Kinit_par(2) = pinit_par*b*DCOS(gamma-beta)/(2.D0*PI)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:104.1:

 this%conic(1) = b**2.D0
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:105.1:

 this%conic(2) = -2.D0*a*b*DCOS(gamma)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:106.1:

 this%conic(3) = a**2.D0
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:107.1:

 this%conic(4) = 2.D0*b*(b*kinit_par(1)-a*kinit_par(2)*DCOS(gamma))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:108.1:

 this%conic(5) = 2.D0*a*(a*kinit_par(2)-b*kinit_par(1)*DCOS(gamma))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:109.1:

 this%conic(6) = -((a*b*DSIN(gamma)/(2.D0*PI))**2.D0)*2.D0*mass*this%inicond%E_
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:112.1:

 CALL VERBOSE_WRITE(routinename,"Total energy: ", E)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:113.1:

 CALL VERBOSE_WRITE(routinename, "Angle between surface main axis (deg): ", gam
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:114.1:

 CALL VERBOSE_WRITE(routinename, "Angle respect to surface main axis u1 (deg): 
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:115.1:

 CALL VERBOSE_WRITE(routinename, "Incidence angle respect to surface plane (deg
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:116.1:

 CALL VERBOSE_WRITE(routinename, "kinit_par 1: ", kinit_par(1))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:117.1:

 CALL VERBOSE_WRITE(routinename, "kinit_par 2: ", kinit_par(2))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:118.1:

 CALL VERBOSE_WRITE(routinename, "Conic A: ", this%conic(1))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:119.1:

 CALL VERBOSE_WRITE(routinename, "Conic B: ", this%conic(2))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:120.1:

 CALL VERBOSE_WRITE(routinename, "Conic C: ", this%conic(3))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:121.1:

 CALL VERBOSE_WRITE(routinename, "Conic D: ", this%conic(4))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:122.1:

 CALL VERBOSE_WRITE(routinename, "Conic E: ", this%conic(5))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:123.1:

 CALL VERBOSE_WRITE(routinename, "Conic F: ", this%conic(6))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:126.1:

 OPEN(11,FILE="OUTallowedpeaks.out", STATUS="replace")
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:127.1:

 WRITE(11,*) "# ----- ALLOWED PEAKS---------------------------------------"
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:128.1:

 WRITE(11,*) "# Format: id, order, n, m, Psi(rad), Phi(rad), Theta_out(rad)   "
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:129.1:

 WRITE(11,*) "#-----------------------------------------------------------"
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:130.1:

 order = 0
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:131.1:

 count_peaks = 0
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:132.1:

 ALLOCATE(allowed(1))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:133.1:

 g(1) = 0
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:134.1:

 g(2) = 0
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:135.1:

 allowed(1) = this%evaluate_peak(g(1),g(2))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:136.1:

 IF(allowed(1)) THEN
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:137.1:

  count_peaks = count_peaks + 1
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:138.1:

  p(1) = pinit_par+(2.D0*PI/(a*b*DSIN(gamma)))*(DFLOAT(g(1))*b*DSIN(gamma-beta)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:139.1:

  p(2) = (2.D0*PI/(a*b*DSIN(gamma)))*(DFLOAT(g(2))*a*DCOS(beta)+DFLOAT(g(1))*b*
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:140.1:

  p(3) = DSQRT(2.D0*mass*E-p(1)**2.D0-p(2)**2.D0)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:141.1:

  Psi = DATAN(p(2)/p(1))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:142.1:

  Phi = DATAN(p(2)/p(3))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:143.1:

  Theta_out = DATAN(p(3)/(DSQRT(p(1)**2.D0+p(2)**2.D0)))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:144.1:

  WRITE(11,*) count_peaks, order, g, Psi, Phi, Theta_out
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:145.1:

 END IF
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:146.1:

 DEALLOCATE(allowed)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:147.1:

 DO
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:148.1:

  order = order + 1
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:149.1:

  i = 0
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:150.1:

  ALLOCATE(allowed(8*order))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:152.1:

  g(1) = order
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:153.1:

  DO k = -order, order
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:154.1:

   g(2) = k
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:155.1:

   i = i + 1
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:156.1:

   allowed(i) = this%evaluate_peak(g(1),g(2))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:157.1:

   IF(allowed(i)) THEN
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:158.1:

    count_peaks = count_peaks + 1
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:159.1:

    p(1) = pinit_par+(2.D0*PI/(a*b*DSIN(gamma)))*(DFLOAT(g(1))*b*DSIN(gamma-bet
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:160.1:

    p(2) = (2.D0*PI/(a*b*DSIN(gamma)))*(DFLOAT(g(2))*a*DCOS(beta)-DFLOAT(g(1))*
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:161.1:

    p(3) = DSQRT(2.D0*mass*E-p(1)**2.D0-p(2)**2.D0)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:162.1:

    Psi = DATAN(p(2)/p(1))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:163.1:

    Phi = DATAN(p(2)/p(3))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:164.1:

    Theta_out = DATAN(p(3)/(DSQRT(p(1)**2.D0+p(2)**2.D0)))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:165.1:

    WRITE(11,*) count_peaks, order, g, Psi, Phi, Theta_out
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:166.1:

   END IF
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:167.1:

  END DO
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:169.1:

  g(1) = -order
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:170.1:

  DO k = -order, order
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:171.1:

   g(2) = k
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:172.1:

   i = i + 1
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:173.1:

   allowed(i) = this%evaluate_peak(g(1),g(2))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:174.1:

   IF(allowed(i)) THEN
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:175.1:

    count_peaks = count_peaks + 1
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:176.1:

    p(1) = pinit_par+(2.D0*PI/(a*b*DSIN(gamma)))*(DFLOAT(g(1))*b*DSIN(gamma-bet
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:177.1:

    p(2) = (2.D0*PI/(a*b*DSIN(gamma)))*(DFLOAT(g(2))*a*DCOS(beta)-DFLOAT(g(1))*
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:178.1:

    p(3) = DSQRT(2.D0*mass*E-p(1)**2.D0-p(2)**2.D0)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:179.1:

    Psi = DATAN(p(2)/p(1))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:180.1:

    Phi = DATAN(p(2)/p(3))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:181.1:

    Theta_out = DATAN(p(3)/(DSQRT(p(1)**2.D0+p(2)**2.D0)))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:182.1:

    WRITE(11,*) count_peaks, order, g, Psi, Phi, Theta_out
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:183.1:

   END IF
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:184.1:

  END DO
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:186.1:

  g(2) = order
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:187.1:

  DO k = -order +1, order-1
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:188.1:

   g(1) = k
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:189.1:

   i = i + 1
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:190.1:

   allowed(i) = this%evaluate_peak(g(1),g(2))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:191.1:

   IF(allowed(i)) THEN
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:192.1:

    count_peaks = count_peaks + 1
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:193.1:

    p(1) = pinit_par+(2.D0*PI/(a*b*DSIN(gamma)))*(DFLOAT(g(1))*b*DSIN(gamma-bet
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:194.1:

    p(2) = (2.D0*PI/(a*b*DSIN(gamma)))*(DFLOAT(g(2))*a*DCOS(beta)-DFLOAT(g(1))*
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:195.1:

    p(3) = DSQRT(2.D0*mass*E-p(1)**2.D0-p(2)**2.D0)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:196.1:

    Psi = DATAN(p(2)/p(1))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:197.1:

    Phi = DATAN(p(2)/p(3))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:198.1:

    Theta_out = DATAN(p(3)/(DSQRT(p(1)**2.D0+p(2)**2.D0)))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:199.1:

    WRITE(11,*) count_peaks, order, g, Psi, Phi, Theta_out
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:200.1:

   END IF
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:201.1:

  END DO
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:203.1:

  g(2) = -order
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:204.1:

  DO k = -order +1, order-1
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:205.1:

   g(1) = k
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:206.1:

   i = i + 1
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:207.1:

   allowed(i) = this%evaluate_peak(g(1),g(2))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:208.1:

   IF(allowed(i)) THEN
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:209.1:

    count_peaks = count_peaks + 1
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:210.1:

    p(1) = pinit_par+(2.D0*PI/(a*b*DSIN(gamma)))*(DFLOAT(g(1))*b*DSIN(gamma-bet
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:211.1:

    p(2) = (2.D0*PI/(a*b*DSIN(gamma)))*(DFLOAT(g(2))*a*DCOS(beta)-DFLOAT(g(1))*
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:212.1:

    p(3) = DSQRT(2.D0*mass*E-p(1)**2.D0-p(2)**2.D0)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:213.1:

    Psi = DATAN(p(2)/p(1))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:214.1:

    Phi = DATAN(p(2)/p(3))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:215.1:

    Theta_out = DATAN(p(3)/(DSQRT(p(1)**2.D0+p(2)**2.D0)))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:216.1:

    WRITE(11,*) count_peaks, order, g, Psi, Phi, Theta_out
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:217.1:

   END IF
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:218.1:

  END DO
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:219.1:

  DO i = 1, 8*order
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:220.1:

   IF (allowed(i)) THEN
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:221.1:

    need_cycle = .TRUE.
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:222.1:

    EXIT
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:223.1:

   END IF
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:224.1:

   need_cycle = .FALSE.
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:225.1:

  END DO
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:226.1:

  DEALLOCATE(allowed)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:227.1:

  IF (.NOT.need_cycle) EXIT
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:228.1:

 END DO
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:229.1:

 REWIND (11)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:230.1:

 ALLOCATE(this%peaks(1:count_peaks))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:231.1:

 READ(11,*) ! dummy line
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:232.1:

 READ(11,*) ! dummy line
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:233.1:

 READ(11,*) ! dummy line
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:234.1:

 DO i=1, count_peaks
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:235.1:

  READ(11,*) this%peaks(i)%id, this%peaks(i)%order, this%peaks(i)%g(1), this%pe
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:236.1:

      this%peaks(i)%Psi, this%peaks(i)%Phi, this%peaks(i)%Theta_out
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:237.1:

  this%peaks(i)%prob = 0.D0
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:238.1:

 END DO
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:239.1:

 CLOSE(11)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:240.1:

 RETURN
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:249.1:

 IMPLICIT NONE
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:251.1:

 CLASS(Allowed_peaksCRP6D),INTENT(INOUT):: this
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:253.1:

 INTEGER(KIND=4) :: lines
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:254.1:

 INTEGER(KIND=4) :: id
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:255.1:

 INTEGER(KIND=4) :: dummy_int
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:256.1:

 INTEGER(KIND=4) :: i,j ! counters
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:257.1:

 INTEGER(KIND=4), DIMENSION(2) :: g
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:258.1:

 REAL(KIND=8), DIMENSION(:), ALLOCATABLE :: peaks_prob
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:259.1:

 REAL(KIND=8), DIMENSION(2,2) :: to_rec_space
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:260.1:

 REAL(KIND=8) :: dummy_real
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:262.1:

 REAL(KIND=8) :: gamma ! angle between unit cell surface vectors
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:263.1:

 REAL(KIND=8), DIMENSION(2) :: p ! final momentum
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:264.1:

 REAL(KIND=8), DIMENSION(2) :: dp ! variation of momentum
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:265.1:

 REAL(KIND=8), DIMENSION(2) :: dk ! variation of momentum in rec. space coord
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:266.1:

 CHARACTER(LEN=10) :: stat
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:267.1:

 CHARACTER(LEN=23), PARAMETER :: routinename = "ASSIGN_PEAKS_TO_TRAJS: "
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:270.1:

 REAL(KIND=8) :: beta ! angle between incident parallel momentum respect to u1 
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:271.1:

 REAL(KIND=8) :: a, b ! length of surface main axis
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:273.1:

 beta=this%inicond%vpar_angle%getvalue()
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:274.1:

 a=this%surf%norm_s1
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:275.1:

 b=this%surf%norm_s2
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:278.1:

 CALL VERBOSE_WRITE(routinename, "Starting job")
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:280.1:

 gamma = DACOS(DOT_PRODUCT(this%surf%s1,this%surf%s2)/(a*b))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:281.1:

 to_rec_space(1,1) = a/(2.D0*PI)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:282.1:

 to_rec_space(1,2) = 0.D0
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:283.1:

 to_rec_space(2,1) = b*DCOS(gamma)/(2.D0*PI)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:284.1:

 to_rec_space(2,2) = b*DSIN(gamma)/(2.D0*PI)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:328.1:

 REWIND(12)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:329.1:

 READ(12,*) ! dummy line
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:330.1:

 READ(12,*) ! dummy line
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:331.1:

 READ(12,*) ! dummy line
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:332.1:

 DO i=1,lines
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:333.1:

  READ(12,*) dummy_int, stat, id
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:334.1:

  this%peaks(id)%prob = this%peaks(id)%prob + 1.D0/lines
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:335.1:

 END DO
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:336.1:

 CLOSE(12)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:337.1:

 CLOSE(11)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:338.1:

 OPEN(13,FILE="OUTseen_peaks.out",STATUS = "replace") ! re-write allowed peaks 
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:339.1:

 WRITE(13,*) "# ----- ALLOWED PEAKS---------------------------------------"
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:340.1:

 WRITE(13,*) "# Format: id, order, n, m, Psi(rad), Phi(rad), Theta_out(rad), Pr
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:341.1:

 WRITE(13,*) "#-----------------------------------------------------------"
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:342.1:

 DO i=1, SIZE(this%peaks)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:343.1:

  IF (this%peaks(i)%prob.NE.0.D0) THEN
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:344.1:

   WRITE(13,*) this%peaks(i)%id,this%peaks(i)%order,this%peaks(i)%g(1),this%pea
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:345.1:

        this%peaks(i)%Psi,this%peaks(i)%Phi,this%peaks(i)%Theta_out,this%peaks(
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:346.1:

  END IF
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:347.1:

 END DO
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:348.1:

 CLOSE(13)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:349.1:

 RETURN
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:359.1:

 IMPLICIT NONE
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:361.1:

 CLASS(Allowed_peaksCRP6D),TARGET,INTENT(IN) :: this
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:362.1:

 INTEGER(KIND=4), INTENT(IN) :: in_n, in_m
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:364.1:

 REAL(KIND=8) :: left_term
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:365.1:

 REAL(KIND=8), POINTER :: A, B, C, D, E, F
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:366.1:

 REAL(KIND=8) :: n, m
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:369.1:

 A => this%conic(1)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:370.1:

 B => this%conic(2)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:371.1:

 C => this%conic(3)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:372.1:

 D => this%conic(4)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:373.1:

 E => this%conic(5)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:374.1:

 F => this%conic(6)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:375.1:

 n = DFLOAT(in_n)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:376.1:

 m = DFLOAT(in_m)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:378.1:

 left_term = A*(n**2.D0) + B*n*m +C*(m**2.D0) + D*n + E*m 
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:386.1:

 RETURN
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:396.1:

 IMPLICIT NONE
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:399.1:

 CHARACTER(LEN=*), INTENT(IN) :: input_file
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:401.1:

 INTEGER(KIND=4) :: lines
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:402.1:

 INTEGER(KIND=4) :: dummy_int
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:403.1:

 REAL(KIND=8) :: dummy_real
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:404.1:

 INTEGER(KIND=4) :: i ! counters
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:405.1:

 INTEGER(KIND=4) :: traj_id
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:406.1:

 CHARACTER(LEN=10) :: stat
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:407.1:

 REAL(KIND=8), DIMENSION(2) :: p
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:408.1:

 REAL(KIND=8) :: angle
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:415.1:

 OPEN(11,FILE=input_file,STATUS="old")
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:416.1:

 READ(11,*) ! Dummy line
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:417.1:

 READ(11,*) ! Dummy line
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:418.1:

 READ(11,*) ! Dummy line
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:419.1:

 DO i=1,lines
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:420.1:

  READ(11,*,iostat=ioerr) traj_id, stat, dummy_int, dummy_int, dummy_real,&
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:428.1:

  IF(stat.EQ."Scattered") THEN
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:429.1:

   angle = DATAN(p(2)/p(1))
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:430.1:

   WRITE(12,*) traj_id, angle
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:431.1:

  END IF
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:432.1:

 END DO
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:433.1:

 CLOSE(11)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:434.1:

 CLOSE(12)
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:435.1:

 RETURN
 1
Warning: Nonconforming tab character at (1)
analysis/diffraction/diffractionCRP6D.f90:96.5:

 E = (this%inicond%E_norm)/(dsin(theta_in))**2.D0
     1
Error: Operands of binary numeric operator '/' at (1) are TYPE(energy)/REAL(8)
make.inc:17: recipe for target 'diffractionCRP6D.o' failed
make: *** [diffractionCRP6D.o] Error 1
